<doc>
<filename>nl.edu1.html</filename>
<url>http://my.nl.edu/</url>
<ip>65.79.10.91</ip>
<title></title>
<body>
<!-- header --> 
<header class="header header-default" hidden> 
 <div class="container-fluid">
  <br>
 </div> 
 <div class="container-fluid"> 
  <div class="pull-left brand float-remove-xs text-center-xs"> <a href="#"> <img src="images/logo-inverse.svg" alt="WSO2" title="WSO2" class="logo"> <h1><em>Identity Server</em></h1> </a> 
  </div> 
 </div> 
</header> <!-- page content --> 
<div class="container-fluid body-wrapper"> 
 <div class="row" hidden> 
  <div class="col-md-12"> <!-- content --> 
   <div class="container col-xs-10 col-sm-6 col-md-6 col-lg-4 col-centered wr-content wr-login col-centered"> 
    <div> 
     <h2 class="wr-title uppercase blue-bg padding-double white boarder-bottom-blue margin-none"> Sign In </h2> 
    </div> 
    <div class="boarder-all "> 
     <div class="clearfix"></div> 
     <div class="padding-double login-form"> 
      <script>
    function goBack() {
        window.history.back();
    }
    
    // Handle form submission preventing double submission.
    $(document).ready(function(){
        $.fn.preventDoubleSubmission = function() {
            $(this).on('submit',function(e){
                var $form = $(this);
                if ($form.data('submitted') === true) {
                    // Previously submitted - don't submit again.
                    e.preventDefault();
                    console.warn("Prevented a possible double submit event");
                } else {
                    e.preventDefault();
                    var userName = document.getElementById("username");
                    userName.value = userName.value.trim();
                    if(userName.value){
                        // Mark it so that the next submit can be ignored.
                        $form.data('submitted', true);
                        document.getElementById("loginForm").submit();
                    }
                }
            });

            return this;
        };
        $('#loginForm').preventDoubleSubmission();
    });
</script> 
      <form action="../commonauth" method="post" id="loginForm"> 
       <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12 form-group"> <label for="username">Username</label> 
        <input id="username" name="username" type="text" class="form-control" tabindex="0" placeholder="" required> 
       </div> 
       <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12 form-group"> <label for="password">Password</label> 
        <input id="password" name="password" type="password" class="form-control" placeholder="" autocomplete="off"> 
       </div> 
       <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12 form-group"> 
        <div class="checkbox"> <label> <input type="checkbox" id="chkRemember" name="chkRemember"> Remember me on this computer </label> 
        </div> 
       </div> 
       <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12"> 
        <input type="hidden" name="sessionDataKey" value="2b1acf28-b636-4aaf-ac23-12336d666016"> 
       </div> 
       <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12 padding-double"> 
        <div class="alert alert-warning margin-bottom-3 padding-10" role="alert"> 
         <div>
           After a successful sign in, we use a cookie in your browser to track your session. You can refer our <a href="cookie_policy.do" target="policy-pane"> Cookie Policy </a> for more details. 
         </div> 
        </div> 
        <div class="alert alert-warning margin-none padding-10" role="alert"> 
         <div>
           By signing in, you agree to our <a href="privacy_policy.do" target="policy-pane"> Privacy Policy </a> 
         </div> 
        </div> 
       </div> 
       <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12 form-group"> 
        <div class="form-actions"> <button class="wr-btn grey-bg col-xs-12 col-md-12 col-lg-12 uppercase font-extra-large margin-bottom-double" type="button" id="submitButton" onclick="submitCredentials(event)"> Sign In </button> 
        </div> 
       </div> 
       <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12 form-group"> 
        <div class="form-actions">
          Forgot <a id="usernameRecoverLink" href="https://id.quicklaunch.io/accountrecoveryendpoint/recoveraccountrouter.do?callback=https%3A%2F%2Fid.quicklaunch.io%3A443%2Fauthenticationendpoint%2Flogin.do%3Fclient_id%3DhnHgcbqBvFe3L2PCdIHvJKLV8lka%26commonAuthCallerPath%3D%252Foauth2%252Fauthorize%26forceAuth%3Dfalse%26passiveAuth%3Dfalse%26redirect_uri%3Dhttps%253A%252F%252Fmy.nl.edu%252Fauth%252Funifyd%252Fpassport%252Fcallback%26response_type%3Dcode%26scope%3Dopenid%26tenantDomain%3Dnl.edu%26sessionDataKey%3D2b1acf28-b636-4aaf-ac23-12336d666016%26relyingParty%3DhnHgcbqBvFe3L2PCdIHvJKLV8lka%26type%3Doidc%26sp%3Dmyunifyed.nl.edu%26isSaaSApp%3Dfalse%26authenticators%3DBasicAuthenticator%3ALOCAL&amp;isUsernameRecovery=true"> Username </a> or <a id="passwordRecoverLink" href="https://id.quicklaunch.io/accountrecoveryendpoint/recoveraccountrouter.do?callback=https%3A%2F%2Fid.quicklaunch.io%3A443%2Fauthenticationendpoint%2Flogin.do%3Fclient_id%3DhnHgcbqBvFe3L2PCdIHvJKLV8lka%26commonAuthCallerPath%3D%252Foauth2%252Fauthorize%26forceAuth%3Dfalse%26passiveAuth%3Dfalse%26redirect_uri%3Dhttps%253A%252F%252Fmy.nl.edu%252Fauth%252Funifyd%252Fpassport%252Fcallback%26response_type%3Dcode%26scope%3Dopenid%26tenantDomain%3Dnl.edu%26sessionDataKey%3D2b1acf28-b636-4aaf-ac23-12336d666016%26relyingParty%3DhnHgcbqBvFe3L2PCdIHvJKLV8lka%26type%3Doidc%26sp%3Dmyunifyed.nl.edu%26isSaaSApp%3Dfalse%26authenticators%3DBasicAuthenticator%3ALOCAL&amp;isUsernameRecovery=false"> Password </a> ? 
        </div> 
        <div class="form-actions"> 
        </div> 
       </div> 
       <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12 form-group"> 
        <div class="form-actions">
          Don't have an account? <a id="registerLink" href="https://id.quicklaunch.io/accountrecoveryendpoint/register.do?callback=https%3A%2F%2Fid.quicklaunch.io%3A443%2Fauthenticationendpoint%2Flogin.do%3Fclient_id%3DhnHgcbqBvFe3L2PCdIHvJKLV8lka%26commonAuthCallerPath%3D%252Foauth2%252Fauthorize%26forceAuth%3Dfalse%26passiveAuth%3Dfalse%26redirect_uri%3Dhttps%253A%252F%252Fmy.nl.edu%252Fauth%252Funifyd%252Fpassport%252Fcallback%26response_type%3Dcode%26scope%3Dopenid%26tenantDomain%3Dnl.edu%26sessionDataKey%3D2b1acf28-b636-4aaf-ac23-12336d666016%26relyingParty%3DhnHgcbqBvFe3L2PCdIHvJKLV8lka%26type%3Doidc%26sp%3Dmyunifyed.nl.edu%26isSaaSApp%3Dfalse%26authenticators%3DBasicAuthenticator%3ALOCAL"> Register Now </a> 
        </div> 
       </div> 
      </form>
     </div> 
     <div class="clearfix"></div>  
     <script src="https://cas.quicklaunch.io/REST/QuickLaunchWSO2HostToDomainMapScript?v=5.19" type="text/javascript"></script> 
     <script>

//ClearPassMutualLogin start

$(document).ready(function () {
   //to prevent multiple binding
    /* $(document).unbind("keyup").keyup(function(e){
        var code = e.which; // recommended to use e.which, it's normalized across browsers
        if(code==13) {
            $("#submitButton").click();
        }
    }); */
});

function setError(errorText) {
     alert(errorText);
}

function clearPassMutualAuth1() {
     document.getElementById('username').value = document.getElementById('username1').value;
     // $("#loginForm").submit(); // TODO Un-comment it if CAS is not available
     var userName = document.getElementById("username").value;
     var tenantDomain = document.getElementById("tenantDomain") == null ? undefined : document.getElementById("tenantDomain").value;
     var nameParts = userName.split("@");
     if (userName && userName.indexOf("@") == -1 && (undefined != tenantDomain) ) {
        document.getElementById('username').value = userName+'@'+tenantDomain;
        userName = document.getElementById("username").value;
        nameParts = userName.split("@");
     }

     // Hiding original with a fake one to hide appended domain
     var original = document.getElementById("username1");
     var originalParent = original.parentElement;
     original.style.display = "none";
     original.style.width = "0px";
     original.style.height = "0px";
     // Now create a fake input to show
     var e = document.createElement("input");
     e.type = "text";
     e.value = nameParts[0];
     e.className = "form-control";
     e.tabindex = 0;
     e.placeholder = "Username";
     e.id = "fakeInput";
     originalParent.appendChild(e);
     e.style.visibility = "visible";
     e.style.padding = "8px 8px"
     e.style.height = "42px";

     if (nameParts.length == 2) {
           var tenantDomain = nameParts[1];
           var tenantHost = quickLaunchWSO2HostMap[tenantDomain];
           if (undefined != tenantHost) {
                  //if we have a mapped host name we should try to register the ClearPassMutualLogin attempt
                  var casAuthUrl = "https://" + tenantHost + "/cas/ClearPassMutualLogin";
                  var password = document.getElementById("password");

                  var casAuthTimeOutMessage = 'ADFS/CAS Time out';
                  var casAuthTimeOutMilliseconds = 25000;

                  //First disable the logon button button
                  var logonSpan = document.getElementById('submitButton');
                  var logonOnclick = logonSpan.onclick;
                  var logonOnkeypress = logonSpan.onkeypress;
                  logonSpan.onclick = function () { return false; };
                  logonSpan.onkeypress = function () { return false; };

                  var callbackSignature = new Date().getTime().toString();
                  //create an iframe to host the mutual authentication post form
                  var casFrameName = 'casMutualAuthFrame_' + callbackSignature;
                  var casFrameDiv = document.createElement("div");
                  casFrameDiv.style.display = 'none';
                  casFrameDiv.innerHTML = "<iframe width='0' height='0' name='" + casFrameName + "' id='" + casFrameName + "' src='about:blank' style='visibility:hidden;'></iframe>";
                  document.body.appendChild(casFrameDiv);

                  //now build a post form for use in the iframe with our username and password values
                  var casFormName = 'casMutualAuthForm_' + callbackSignature;
                  var casFormHtml = "<form method='POST' action='" + casAuthUrl + "' id='" + casFormName + "' name='" + casFormName + "' >";
                  casFormHtml += "<input type='hidden' name='casUserName' value='" + userName + "'>";
                  casFormHtml += "<input type='hidden' name='plainTextPassword' value='" + password.value + "'>";
                  casFormHtml += "<input type='hidden' name='callbackSignature' value='" + callbackSignature + "'>";
                  casFormHtml += "</form>";

                  //now add the postform to the iframe
                  var casFrame = document.getElementById(casFrameName);
                  var casDocument = casFrame.contentDocument || casFrame.contentWindow.document;
                  var casFormDiv = casDocument.createElement("div");
                  casFormDiv.style.display = 'none';
                                  casFormDiv.innerHTML = casFormHtml;
                  if (casDocument.documentElement) {
                         //Chrome, Firefox, Safari
                         casDocument.documentElement.appendChild(casFormDiv);
                  }
                  else {
                         //IE and Edge specific
                         casDocument.appendChild(casFormDiv);
                  }
                  var casTimedOut = false;
                  var casAuthForm = casDocument.getElementById(casFormName)
                  var casTimeout = 0;
                                  if (casAuthTimeOutMilliseconds > 0) {
                     casTimeout = window.setTimeout(function () {
                            casTimedOut = true;
                            logonSpan.onclick = logonOnclick;
                            logonSpan.onkeypress = logonOnkeypress;
                            setError(casAuthTimeOutMessage);
                     }, casAuthTimeOutMilliseconds);
                  }
                  //setup a window listener to wait for our the confirmation message
                  var eventOk = addEventHandler("message", window,
                      //setup a window listener to wait for our the confirmation message
                      function (event) {
                          //verify that the origin is from the expected target
                          var evtOrigin = event.origin || event.originalEvent.origin;
                          evtOrigin = evtOrigin.toLowerCase();
                          if (casAuthUrl.toLowerCase().indexOf(evtOrigin) === 0) {
                              //our callback sends the callbackSignature back as the
                              //text prefix to the data, that way we know its for this
                              //series of click events
                              if (event.data.indexOf(callbackSignature) === 0) {
                                  if (casTimeout !== 0) {
                                          window.clearTimeout(casTimeout);
                                          casTimeout = 0;
                                  }
                                  if (!casTimedOut) {
                                      var callBackMessage = event.data.replace(callbackSignature, '');
                                      logonSpan.onclick = logonOnclick;
                                      logonSpan.onkeypress = logonOnkeypress;
                                      if (callBackMessage === '200') {
                                              document.forms['loginForm'].submit();
                                      }
                                      else {
                                              setError(callBackMessage);
                                      }
                                  }
                              }
                          }
                      });
                  if (eventOk) {
                      casAuthForm.submit();
                  }
                  else {
                      //TODO
                      setError("Incompatible browser");
                  }
                  return false;
           } else { // Else for id domain name is undefined.
              document.forms['loginForm'].submit();
              return true;
           }
     } else { // else for if name parts
      document.forms['loginForm'].submit();
       //not a tenant user name, let form post as normal
       return true;

     }
}

// Event handler for tracking the IE event handling issue.
function addEventHandler(eventName, docElement, eventHandler) {
    if (docElement.addEventListener) {  // W3C DOM
        console.log("Adding event listener (Non IE) for event name "+eventName);
        docElement.addEventListener(eventName, eventHandler, false);
        return true;
    }
    else if (docElement.attachEvent) { // IE DOM
        console.log("Attaching event (IE) for event name "+eventName);
        docElement.attachEvent("on" + eventName, eventHandler);
        return true;
    }
    else {
        return false;
    }
}
// ClearPassMutualLogin ends
// For Handling autosubmit
addEventHandler('message', window, processMessage);
function processMessage(event) {
    var data = event.data;
    if (data.autoLogin && data.username && data.password) {
        var processedUserName = data.username+"@"+angular.element(document.getElementById('loginForm')).scope().qlTenantDomain;
        document.getElementById("branding-username").value = processedUserName;
        document.getElementById("username").value = processedUserName;
        document.getElementById("branding-password").value = data.password;
        document.getElementById("password").value = data.password;
        angular.element(document.getElementById('loginForm')).scope().clearPassMutualAuth();
    }
    console.log("Received Message at IDP"+JSON.stringify(event.data));
}
</script> 
     <div class="clearfix"></div> 
    </div> 
   </div> <!-- /content --> 
  </div> 
 </div> <!-- /content/body --> 
</div>  <!-- footer --> 
<footer class="footer" hidden> 
 <div class="container-fluid"> 
  <p>WSO2 Identity Server | Â© <script>document.write(new Date().getFullYear());</script> <a href="http://wso2.com/" target="_blank"><i class="icon fw fw-wso2"></i> Inc </a>. All rights reserved </p> 
 </div> 
</footer> 
<script>
        $(document).ready(function () {
            $('.main-link').click(function () {
                $('.main-link').next().hide();
                $(this).next().toggle('fast');
                var w = $(document).width();
                var h = $(document).height();
                $('.overlay').css("width", w + "px").css("height", h + "px").show();
            });
            $('[data-toggle="popover"]').popover();
            $('.overlay').click(function () {
                $(this).hide();
                $('.main-link').next().hide();
            });

            
        });
        function myFunction(key, value, name) {
            var object = document.getElementById(name);
            var domain = object.value;


            if (domain != "") {
                document.location = "../commonauth?idp=" + key + "&authenticator=" + value +
                        "&sessionDataKey=2b1acf28-b636-4aaf-ac23-12336d666016&domain=" +
                        domain;
            } else {
                document.location = "../commonauth?idp=" + key + "&authenticator=" + value +
                        "&sessionDataKey=2b1acf28-b636-4aaf-ac23-12336d666016";
            }
        }

        function handleNoDomain(key, value) {
            
            document.location = "../commonauth?idp=" + key + "&authenticator=" + value +
                    "&sessionDataKey=2b1acf28-b636-4aaf-ac23-12336d666016" +
                    "";
        }

        $('#popover').popover({
            html: true,
            title: function () {
                return $("#popover-head").html();
            },
            content: function () {
                return $("#popover-content").html();
            }
        });
        window.onunload = function(){};
    </script> 
<script>
        function changeUsername (e) {
            document.getElementById("changeUserForm").submit();
        }
    </script>  
<script type="text/javascript">
var pmsContextPath = "https://password.quicklaunch.io";         // Change accordingly, environment dependents
var usernameParameter = "#username";           // Change this if username parameter name is different, i.e.- '#username1'
//var idpTenantDomain = "your.tenant.domain.name";              // Needed in case of SAMLized applications
</script> 
<script src="https://sso.quicklaunch.io/admin/resources/rest/idp/js/idp.app.js?v=5.19" type="text/javascript"></script>
</body>
</doc>