<doc>
<filename>okbu.edu5.html</filename>
<url>http://okbu.libcal.com/appointments/?g=479</url>
<ip>18.213.162.18</ip>
<title>Make an Appointment - LibCal - Oklahoma Baptist University</title>
<body>
<div class="sr-only" title="Information for Screenreader Users"> 
</div> <a id="s-lc-public-skiplink" class="s-lc-skiplink alert-info" href="#s-lc-public-pt">Skip to Main Content</a> 
<div class="container"> 
 <div id="s-lc-public-banner" class="row" role="banner"> <a href="http://www.okbu.edu/library/"> <img alt="Oklahoma Baptist University LibCal" class="img-responsive" id="s-lc-public-banner-img" src="//lcimages.s3.amazonaws.com/data/headers/3257/Oklahoma_Baptist_University.png"> <span class="sr-only">Oklahoma Baptist University LibCal</span> </a> 
 </div> 
 <div id="s-lc-public-bc" class="row"> 
  <div class="col-md-12"> 
   <nav aria-label="Breadcrumb"> 
    <ol class="breadcrumb"> 
     <li><a href="http://www.okbu.edu/library/">Oklahoma Baptist University</a></li> 
     <li><a href="/appointments">Appointments</a></li> 
    </ol> 
   </nav> 
  </div> 
 </div> 
 <noscript> 
  <div class="alert alert-danger" id="noscript">
   Your browser has javascript disabled. Without javascript some functions will not work.
  </div> 
 </noscript> 
 <div id="s-lc-public-title" class="row"> 
  <div class="col-md-12"> 
   <h1 id="s-lc-public-pt" class="s-lc-app-booking-header"> Make an Appointment </h1> <span class="sr-only"> Make an appointment in 3 steps. Step 1: Select a staff member. Step 2: Select an available date. Step 3: Select an available timeslot. </span> 
  </div> 
 </div> 
 <main> 
  <div id="s-lc-public-main" class="s-lc-public-main"> 
   <div id="s-lc-public-page-content" class="row"> 
    <div id="col1" class="col-md-12 center"> 
     <div class="row"> 
      <div id="s-lc-app-s1" class="col-md-4" aria-live="polite" style="display:none;"></div> 
      <div aria-live="polite"> 
       <div id="select-date-sr-message"></div> 
      </div> 
      <div id="s-lc-app-s2" class="col-md-4" aria-live="polite" style="display:none;"></div> 
      <div id="s-lc-app-s3" class="col-md-4" aria-live="polite" style="display:none;"></div> 
     </div> 
     <div id="s-lc-app-form-aria-live" aria-live="assertive"> 
      <div id="s-lc-app-s4" style="display:none;"> 
      </div> 
     </div> 
     <div id="s-lc-app-results" style="display:none;"> 
      <div class="row"> 
       <div class="col-md-12"> 
        <div id="alert-register-success-msg" role="region" aria-live="polite" aria-labelledby="s-lc-app-success-intro"> 
         <div id="s-lc-app-success-intro" class="alert alert-success s-lc-appointment-success-intro" role="status" tabindex="0"> <strong>Success!</strong> You are all set. A confirmation email with relevant appointment details was sent to <span id="s-lc-app-success-user-email"></span>. Check your spam folder if you don't see the email in your inbox. 
         </div> 
         <p> <strong>Location:</strong> <span id="s-lc-app-success-location"></span> </p> 
         <p> <strong>Appointment with:</strong> <span id="s-lc-app-success-name"></span> </p> 
         <p> <strong>Date:</strong> <span id="s-lc-app-success-date"></span> </p> 
         <p> <strong>Start Time:</strong> <span id="s-lc-app-success-time"></span> </p> 
         <p class="s-lc-timezone-container"> <strong>Time Zone:</strong> <span id="s-lc-app-success-timezone"></span> </p> 
         <div id="s-lc-appointment-category" style="display:none;"> 
          <p> <strong>Type:</strong> <span id="s-lc-app-success-category"></span> </p> 
         </div> 
         <p> <strong>Directions:</strong> <span id="s-lc-app-success-directions"></span> </p> 
         <div id="s-lc-appointment-online-meeting" style="display:none;"> 
          <p> <strong>Online Meeting URL:</strong> <span id="s-lc-app-success-online-url"> </span> </p> 
         </div> 
        </div> 
        <p> <button class="btn btn-default margin-top-xlg" id="s-lc-ms-sobtn" onclick="return startOver();"> Start Over </button> </p> 
       </div> 
      </div> 
     </div> 
    </div> 
   </div> 
  </div> 
 </main> 
 <footer id="s-lc-public-footer" class="s-lc-public-footer row"> 
  <div id="s-lc-public-footer-brand"> <span title="libcal-us-1">Powered by</span> <a href="https://www.springshare.com">Springshare</a>. 
  </div> 
  <div id="s-lc-public-footer-rights">
    All rights reserved. 
  </div> 
  <div id="s-lc-footer-support-link"> <a href="mailto:syslib@okbu.edu">Report a tech support issue.</a> 
  </div> 
  <div id="s-lc-public-footer-admin-links" role="navigation"> <a id="s-lc-sign-in" href="https://okbu.libapps.com/libapps/login.php?site_id=6990&amp;target=">Librarian Login</a> 
  </div> 
  <div class="s-lc-public-footer-actions"> 
   <div id="s-lc-language"> <select id="s-lc-language-selector" aria-label="Language Selector"> <option value="cy">Cymraeg</option> <option value="en" selected>English</option> <option value="es">español</option> <option value="fr">français</option> <option value="sl">slovenski jezik</option> </select> 
   </div> 
  </div> 
 </footer> 
</div> 
<script src="/js692/direct/public/appointments/success.min.js"></script> 
<script>
    var dateEnabledOnCalendar = [true, "", "Available"];
    var dateDisabledOnCalendar = [false, "", "Not Available"];

    var availableDates = [];

    var springyAppointment = {
        fadeInDuration: 200,
        loadingDisplay: "<p class='text-center'><br/><br/><br/><br/><i class='fa fa-spinner fa-spin fa-2x' aria-hidden='true'></i></p>",
        publicTimezone: 'America/Chicago',
        publicTimezoneDisplay: 'Central Time - US &amp; Canada',
        lang: {
            timezone: "Time Zone",
            changeTimezone: "change",
            continueButtonText: "Continue",
        },
    };

    function categoryGetVisibleId(element) {
        var value = element.data("value");
        if (value !== undefined) {
            return value;
        }

        return parseInt(element.val(), 10);
    }

    function categoryGetVisibleName(element) {
        var value = element.data("value");
        if (value !== undefined) {
            return element.text();
        }

        return element.find("option:selected").text();
    }

    function getSelectedCategoryId() {
        return categoryGetVisibleId(jQuery("#cat_" + selectedGroupId));
    }

    function getSelectedCategoryName() {
        return categoryGetVisibleName(jQuery("#cat_" + selectedGroupId));
    }

    function datePickerEvaluateDate(date) {
        setupCalMonthNavigationButtons();

        var dateString = moment(date).format(springSpace.phpDateFormat);

        if (jQuery.inArray(dateString, availableDates) != -1) {
            return dateEnabledOnCalendar;
        } else {
            return dateDisabledOnCalendar;
        }
    }

    function handleKeypressEnterAsClick(event) {
        if (event.which == 13) {
            jQuery(this).trigger("click");
            setupCalMonthNavigationButtons();
            jQuery(event.data.thisButtonClass).focus();
        }
    }

    function onPanelHeadingKeypress(event) {
        // treat enter as a click
        if (event.which == 13) {
            jQuery(this).trigger("click");
        }
    }

    // support next/prev month buttons via keyboard
    function setupCalMonthNavigationButtons() {
        jQuery(".ui-datepicker-prev")
            .attr("tabindex", 0)
            .attr("aria-label", "Previous Month button")
            .on("keypress", {thisButtonClass: ".ui-datepicker-prev"}, handleKeypressEnterAsClick)
            .on("click", setupCalMonthNavigationButtons);

        jQuery(".ui-datepicker-next")
            .attr("tabindex", 0)
            .attr("aria-label", "Next Month button")
            .on("keypress", {thisButtonClass: ".ui-datepicker-next"}, handleKeypressEnterAsClick)
            .on("click", setupCalMonthNavigationButtons);

        jQuery(".ui-datepicker-month") // ensure that the month dropdown box is accessible
            .prop("title", "Select a month")
            .on("change", setupCalMonthNavigationButtons);
    }

    function formatTimeslotHtml(timeslot, date) {
        var start = moment(timeslot.startDisplay);
        var end = moment(timeslot.endDisplay);

        var html = '<button class="btn btn-default btn-sm s-lc-app-timeslot s-lc-app-timeb" data-uid="' + timeslot.userId + '" data-st="' + timeslot.start + '" data-date="' + date + '" data-crc="' + timeslot.crc + '">';
        html += start.format(springSpace.timeFormat);
        html += '<span class="s-lc-app-timeb-et"> - <span class="sr-only s-lc-app-timeb-et">until </span>';
        html += end.format(springSpace.timeFormat);
        html += '</span>';
        html += '<span class="s-lc-app-timeb-date sr-only">' + end.format(springSpace.dateFormat) + '</span>';

        if (typeof timeslot.directions !== 'undefined') {
            html += '<span class="s-lc-app-timeb-loc">' + timeslot.directions + '</span>';
        }

        html += '</button><span class="sr-only">, </span>';

        return html;
    }

    function createTimeslotContinueButton() {
        return '<div class="text-center"><button type="button" id="s-lc-app-continue" class="btn btn-primary margin-top-med s-lc-app-s3-alignment" disabled="disabled">' + springyAppointment.lang.continueButtonText + '</button></div>';
    }

    function hideAll() {
        jQuery("#s-lc-app-s1, #s-lc-app-s2, #s-lc-app-s2-content, #s-lc-app-s3, #s-lc-app-s4, #s-lc-app-results").hide();
    }

    function startOver() {
        window.location.reload(false);
        return false;
    }

    function onBookingCreateSuccess(data) {
        hideAll();
        populateBookingSuccessValues(data);
        jQuery("#s-lc-app-results").fadeIn(springyAppointment.fadeInDuration);
    }

    function showStaffMemberInfo(id) {
        jQuery("#s-lc-staff-member-info-" + id).modal("show");

        return false;
    }

    function groupPanelsSetupArrows() {
        jQuery('.collapse').on('show.bs.collapse', function () {
            jQuery(this).siblings().find('.s-lc-public-panel-indicator').addClass('fa-chevron-down').removeClass('fa-chevron-right');
        });

        jQuery('.collapse').on('hide.bs.collapse', function () {
            jQuery(this).siblings().find('.s-lc-public-panel-indicator').addClass('fa-chevron-right').removeClass('fa-chevron-down');
        });
    }
</script> 
<script>
        var dateTimeRequestInProgress = false;

        function getStaffList() {
            hideAll();
            jQuery("#s-lc-app-s1").html(springyAppointment.loadingDisplay).fadeIn(springyAppointment.fadeInDuration);

            jQuery.ajax({
                type: "get",
                url: "/widget/appointments/staff",
                data: {
                    iid: 3257,
                    lid: 1073,
                    uid: 0,
                    gid: 479,
                },
                dataType: "json",
                success: function (data) {
                    var html = data.html ? data.html : '<div class="alert alert-danger">Sorry,\u0020there\u0020are\u0020no\u0020times\u0020available.</div>';
                    jQuery("#s-lc-app-s1").html(html).fadeIn(springyAppointment.fadeInDuration);

                    showSpecificGroup();

                    var staffRadioButtonElements = jQuery('.s-lc-app-sl');
                    staffRadioButtonElements.on('click', onStaffMemberClicked);

                    // Move focus on datepicker when enter or space is pressed on staff member radio button
                    springyCommon.bindAccessibleKeyPress(staffRadioButtonElements, moveFocusOnDatepicker);

                    catGroupListen();
                    groupPanelsSetupArrows();
                    accessibleIcons();
                    jQuery(".panel-heading").on("click", onPanelHeadingClick).on("keypress", onPanelHeadingKeypress);
                    catListen();
                    setupCalMonthNavigationButtons();

                    if (!data.fetchDates) {
                        return;
                    }

                    getDatesAndTimes();
                },
            });

            return false;
        }

        function moveFocusOnDatepicker() {
            jQuery('#s-lc-app-dp').find('.ui-state-default.ui-state-active').trigger('focus');
        }

        function onPanelHeadingClick() {
            // this function makes a group active
            var section = jQuery(this).attr("aria-controls");

            // select the first user (or no preference) in this group by default
            var firstUser = jQuery("#" + section).find("input[type=radio]").first();
            firstUser.prop("checked", true);

            var cid = categoryGetVisibleId(jQuery("#" + section + " .groupcat_filtering"));
            if (cid > 0) {
                jQuery("#cid").val(cid);
            }

            getDatesAndTimes();

            return true;
        }

        function showSpecificGroup() {
            var groupId = 479;
            if (groupId < 1) {
                return true;
            }

            jQuery(".group_panel").hide();
            jQuery("#collapse" + groupId).addClass("in");

            jQuery(".group_" + groupId + " input[name=staff]").first().trigger("click");

            jQuery(".group_" + groupId).show();
            jQuery(".groupnt_" + groupId).show();

            if (jQuery(".groupnt_" + groupId).is(":visible")) {
                jQuery("#s-lc-app-s1date, #s-lc-app-s1time").remove();
            }

            return true;
        }

        function onStaffMemberClicked(event) {
            // this prevents people clicking a staff member and then clicking a different one
            // quickly before the datetime request completes
            if (dateTimeRequestInProgress) {
                event.preventDefault();
                return false;
            }

            dateTimeRequestInProgress = true;
            getDatesAndTimes();

            return true;
        }

        function getSelectedUserElement() {
            return jQuery("input[name=staff]:checked", "#s-lc-app-slist");
        }

        function getDatesAndTimes() {
            jQuery("#s-lc-app-s2, #s-lc-app-s3").hide().html(springyAppointment.loadingDisplay).fadeIn(springyAppointment.fadeInDuration);

            var selectedUser = getSelectedUserElement();
            var uid = selectedUser.data("uid");
            var gid = selectedUser.data("gid");
            var cid = jQuery("#cid").val();

            setupCalMonthNavigationButtons();

            jQuery.ajax({
                type: "get",
                url: "/widget/appointments/datetime",
                data: {
                    iid: 3257,
                    lid: 1073,
                    uid: uid,
                    gid: gid,
                    cid: cid,
                    timezone: springyAppointment.publicTimezone,
                },
                dataType: "json",
                success: function (data) {
                    availableDates = data.dates;

                    jQuery("#s-lc-app-s2").html('<h2 class="s-lc-app-s1h3" tabindex=0 aria-label="Step 2. Select\u0020Date\u003A">2. Select\u0020Date\u003A</h2><div id="s-lc-app-dp"></div>').fadeIn(springyAppointment.fadeInDuration);

                    if (data.times) {
                        var timeslots = data.times;
                        var date = data.date;
                        var html = '<h2 class="s-lc-app-s1h3" aria-label="Step 3: Select\u0020Time\u003A">3. Select\u0020Time\u003A</h2>';

                        html += '<h3 id="s-lc-app-timeh">' + moment(date).format(springSpace.dateFormat) + '</h3>';
                        html += getTimezoneDisplay();

                        for (var i=0; i < timeslots.length; i++) {
                            html += formatTimeslotHtml(timeslots[i], date);
                        }

                        html += createTimeslotContinueButton();

                        jQuery("#s-lc-app-s3").hide().html(html).fadeIn(springyAppointment.fadeInDuration);
                        jQuery(".s-lc-app-timeb").on("click", onTimeslotClicked);
                        jQuery('#s-lc-app-continue').on('click', progressToBookingForm);
                        bindTimezoneModal();
                    } else {
                        jQuery("#s-lc-app-s3").hide();
                    }

                    var viewDate = (data.dates && data.dates.length > 0) ? data.dates[0] : "";
                    setupDatepicker(viewDate);

                    dateTimeRequestInProgress = false;
                },
            });

            return false;
        }

        function getTimezoneDisplay() {
            return '<div class="s-lc-timezone-container s-lc-app-change-tz-cont pad-top-med pad-bottom-med">'
                + springyAppointment.lang.timezone + ': ' + springyAppointment.publicTimezoneDisplay
                + ' (<a href="#" class="s-lc-app-change-tz-modal">' + springyAppointment.lang.changeTimezone + '</a>)'
                + '</div>';
        }

        function bindTimezoneModal() {
            jQuery('.s-lc-app-change-tz-modal').off('click').on('click', springyPublic.showTimezoneModal);
        }

        function setupDatepicker(dateDefault) {
            jQuery("#s-lc-app-dp").datepicker({
                dateFormat: "yy-mm-dd",
                changeMonth: true,
                defaultDate: dateDefault,
                onSelect: function (date) {
                    datePickerSelectDate()
                },
                beforeShowDay: datePickerEvaluateDate,
                onChangeMonthYear: calChangeMonthYear
            });

            setupCalMonthNavigationButtons();
        }

        function calChangeMonthYear(year, month, inst) {
            setupCalMonthNavigationButtons();
            jQuery("#select-date-sr-message").html("<h2 class=\"sr-only\">Step 2. Showing calendar for month " + month + " " + year + "</h2>");
        }

        function datePickerSelectDate() {
            var date = jQuery("#s-lc-app-dp").val();
            var selectedUser = getSelectedUserElement();
            var uid = selectedUser.data("uid");
            var gid = selectedUser.data("gid");
            var cid = jQuery("#cid").val();

            jQuery("#s-lc-app-s3").html(springyAppointment.loadingDisplay).fadeIn(springyAppointment.fadeInDuration);

            setupCalMonthNavigationButtons();

            jQuery.ajax({
                type: "get",
                url: "/widget/appointments/times",
                data: {
                    iid: 3257,
                    lid: 1073,
                    uid: uid,
                    gid: gid,
                    cid: cid,
                    date: date,
                    timezone: springyAppointment.publicTimezone,
                },
                dataType: "json",
                success: function (data) {
                    var html = '<h2 class="s-lc-app-s1h3" aria-label="Step 3. Select\u0020Time\u003A">3. Select\u0020Time\u003A</h2>';
                    var timeslots = data.times;

                    if (!timeslots || (timeslots.length === 0)) {
                        html += '<div class="alert alert-danger">Sorry,\u0020there\u0020are\u0020no\u0020times\u0020available.</div>';
                    } else {
                        html += '<h3 id="s-lc-app-timeh">' + moment(date).format(springSpace.dateFormat) + '</h3>';
                        html += getTimezoneDisplay();

                        for (var i=0; i < timeslots.length; i++) {
                            html += formatTimeslotHtml(timeslots[i], date);
                        }

                        html += createTimeslotContinueButton();
                    }

                    jQuery("#s-lc-app-s3").hide().html(html).fadeIn(springyAppointment.fadeInDuration).focus();

                    var timeSlotElements = jQuery('.s-lc-app-timeb');
                    timeSlotElements.on('click', onTimeslotClicked);
                    timeSlotElements.first().trigger('focus');
                    jQuery('#s-lc-app-continue').on('click', progressToBookingForm);

                    setupCalMonthNavigationButtons();
                    bindTimezoneModal();
                },
            });

            return false;
        }

        function onTimeslotClicked() {
            jQuery('#s-lc-app-continue').prop('disabled', false).focus();
            jQuery('.s-lc-app-timeslot').removeClass('active');
            jQuery(this).addClass('active');

            return false;
        }

        function redirectToLibAuthLogin(clickedSlot, userId, groupId, categoryId) {
            window.location = '/appointments-auth/prepare?' + jQuery.param({
                iid: 3257,
                lid: 1073,
                uid: userId,
                gid: groupId,
                cid: categoryId,
                startTime: clickedSlot.data('st'),
                checksum: clickedSlot.data('crc'),
            });

            return false;
        }

        function isUserLibAuthEnabled(selectedStaffElement, userId) {
            // if the selected staff member is an actual user
            // then we can use the libauth attribute from that element
            var selectedStaffId = selectedStaffElement.data('uid');
            if (selectedStaffId === userId) {
                return selectedStaffElement.data('libauth');
            }

            // otherwise it means that the selected staff option is either 'no preference' or a group nickname
            // try to get the selected users libauth setting by looking up their id
            var userElement = jQuery('input[name=staff][data-uid=' + userId + ']', '#s-lc-app-slist');
            if (userElement.length > 0) {
                return userElement.data('libauth');
            }

            // if we couldn't look them up it means the group is using group nicknames
            // in this case we return false here and the booking form step
            // will determine the libauth settings of the user
            return false;
        }

        function progressToBookingForm() {
            var clickedSlot = jQuery('.s-lc-app-timeslot.active');
            var userId = clickedSlot.data("uid");

            var selectedUser = getSelectedUserElement();
            var groupId = selectedUser.data("gid");
            var isLibAuth = isUserLibAuthEnabled(selectedUser, userId);
            var categoryId = jQuery("#cid").val();

            if (isLibAuth) {
                return redirectToLibAuthLogin(clickedSlot, userId, groupId, categoryId);
            }

            hideAll();

            /* Hide page title on mobile view on the final step */
            jQuery('#s-lc-public-title').addClass('s-lc-desktop-only');

            jQuery("#s-lc-app-s4").html(springyAppointment.loadingDisplay).fadeIn(springyAppointment.fadeInDuration);

            setupCalMonthNavigationButtons();

            jQuery.ajax({
                type: "get",
                url: "/widget/appointments/form",
                data: {
                    iid: 3257,
                    lid: 1073,
                    uid: userId,
                    gid: groupId,
                    cid: categoryId,
                    startTime: clickedSlot.data('st'),
                    checksum: clickedSlot.data('crc'),
                    timezone: springyAppointment.publicTimezone,
                    nocache: true,
                },
                dataType: "html",
                success: function (html) {
                    jQuery("#s-lc-app-s4").html(html).fadeIn(springyAppointment.fadeInDuration);
                    accessibleIcons();
                    setupCalMonthNavigationButtons();
                    jQuery('#s-lc-public-pd').hide();
                    jQuery('#s-lc-app-back-to-step1').on('click', backToStep1);
                },
            });

            return false;
        }

        function catListen() {
            jQuery("#cid").on("change", getDatesAndTimes);
            setupCalMonthNavigationButtons();
        }

        function catGroupListen() {
            var cid = categoryGetVisibleId(jQuery("#s-lc-app-slist").find(".groupcat_filtering").filter(":visible").first());
            if (cid > 0) {
                jQuery("#cid").val(cid);
            }

            jQuery(".groupcat_filtering").change(function () {
                var cid = parseInt(jQuery(this).val(), 10);
                jQuery("#cid").val(cid);
                getDatesAndTimes();
            });

            setupCalMonthNavigationButtons();
        }

        function backToStep1() {
            hideAll();

            /* Unhide page title on mobile view */
            jQuery('#s-lc-public-title').removeClass('s-lc-desktop-only');

            jQuery("#s-lc-app-s1").fadeIn(springyAppointment.fadeInDuration);
            jQuery('#s-lc-public-pd').show();

            jQuery('#s-lc-app-s2').show();
            var date = jQuery(this).data('date');
            jQuery('#s-lc-app-dp').val(date);
            datePickerSelectDate(date);

            return false;
        }

        function goToLocationPage() {
            var url = jQuery(this).val();
            window.location = url;

            return false;
        }

        jQuery(function() {
            //ensure that datepicker hasn't removed accessibility for next/prev calendar buttons
            jQuery(document).on("keydown", setupCalMonthNavigationButtons);
            jQuery('#s-lc-app-location').on('change', goToLocationPage);

            getStaffList();
        });
    </script>
</body>
</doc>